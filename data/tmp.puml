@startuml tmp
!theme plain
skinparam componentStyle uml2

package "数据采集阶段" {
  component [scrape_vgchartz.py] as Scraper
  database "VGChartz Website" as Web
  file "vgchartz_scrape.csv\n(原始数据)" as RawCSV
}

package "数据清洗与存储阶段" {
  component [clean_and_store.py] as Cleaner
  file "vgsales_clean.parquet\n(清洗后数据)" as Parquet
  database "PostgreSQL\n(vgchartz_clean 表)" as DB
  file "data_quality.json\n(质量报告)" as QualityReport
}

package "分析与可视化管道" {
  component [pipeline.py] as Pipeline
  component "ML Analyzer" as ML
  component "Figure Generator" as Plotter
  component "Dashboard Builder" as DashBuilder
}

package "输出成果" {
  file "analysis_metrics.json\n(分析指标)" as Metrics
  file "analysis_summary.md\n(中文摘要)" as Summary
  folder "gallery/*.png\n(静态图表)" as Gallery
  file "interactive_dashboard.html\n(交互式仪表盘)" as Dashboard
  file "ml_artifacts\n(预测/聚类结果)" as MLOut
}

' 关系定义
Web -> Scraper : HTTP Requests
Scraper -> RawCSV : 输出原始CSV

RawCSV -> Cleaner : 读取
Cleaner -> Parquet : 保存
Cleaner -> DB : 写入
Cleaner -> QualityReport : 生成

DB -> Pipeline : 读取数据 (优先)
Parquet -> Pipeline : 读取数据 (备选)

Pipeline --> ML : 调用分析
Pipeline --> Plotter : 调用绘图
Pipeline --> DashBuilder : 构建仪表盘

Pipeline --> Metrics : 输出
Pipeline --> Summary : 输出
ML --> MLOut : 输出模型结果
Plotter --> Gallery : 输出图片
DashBuilder --> Dashboard : 生成HTML

@enduml